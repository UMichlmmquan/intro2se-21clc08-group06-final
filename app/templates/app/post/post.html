{% extends 'app/base.html' %}
{% load static %}
{% block main-content %}
<!-- Message display code -->
{% if messages %}
<div class="container mt-3">
  <div class="row">
    <div class="col-md-12">
      {% for message in messages %}
      {% if message.extra_tags == 'report_post' %}
            <div class="alert alert-danger" role="alert">
                  {{ message }}
            </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
</div>
{% endif %}
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="">
    
</head>
<body>
    
<section style="background-color: #eee;">
    <div class="container">
        <div class="row justify-content-center mt-5">
            <div class="col-md-10 col-sm-12 text-center">
                <h1 class="display-10">{{ post.caption }}</h1>
            </div>
        </div>
    </div>

    <div class="container">
      <div class="row justify-content-left">
          <div class="col-md-6 offset-md-3">
              <div class="card mb-4 post-card">
                  <a href="{% url 'post' post_id=post.id %}">
                    {% if post.pic_url %}
                    <img src="{{ post.pic_url.url }}" alt="{{ post.caption }}"  class="card-img-top-center img-fluid mx-auto d-block">
                    {% else %}
                    <img src="{% static 'app/image/logo.jpg' %}" alt="{{ post.caption }}" class="card-img-top img-fluid">
                    {% endif %}
                  </a>
              </div>
          </div>
      </div>
  </div>
  
    <div class="container h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-lg-12 col-xl-11">
                <div class="card text-black" style="border-radius: 25px;">
                    <div class="card-body p-md-5">
                        <div class="row justify-content-left">
                            <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">
                                <div class="text-left fw-bold">
                                    {% if messages %}
                                        {% for message in messages %}
                                            <div>{{ message }}</div>
                                        {% endfor %}
                                    {% endif %}
                                </div>

                                <form class="mx-1 mx-md-4" method="POST" action="">
                                    {% csrf_token %} 
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-user fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Company Name: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.company_name }}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-envelope fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Contact: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.contact }}</p>                               
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Address: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.address }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">City: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.city }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-key fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Introduction: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.introduction }}</p>                               
                                        </div>
                                    </div>
                                
                                    <!--  Additional fields    -->
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-briefcase fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Field: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.field }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-briefcase fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Job: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.job }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-info-circle fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Job Description: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.description }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-clock fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Hour: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.hour }}</p>
                                        </div>
                                    </div>
                                
                                    <div class="d-flex flex-row align-items-center mb-2 details_of_entry">
                                        <div class="w-50">
                                            <i class="fas fa-money-bill-alt fa-lg me-3 fa-fw"></i>
                                            <label class="form-label">Salary: </label>
                                        </div>
                                        <div class="w-50">
                                            <p class="form-control border-0" readonly>{{ post.salary }}</p>
                                        </div>
                                    </div>
                                </form>
                                
                               
                  
                            </div>
                          
                        </div>
                        {% if user.is_job_finder %}
                        <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                          <a type="apply" class="btn btn-primary btn-lg"  href="{% url 'apply' post_id=post.id%}" >Apply</a>
                        </div>
                        {% endif %}
                        
                        
                    </div>
                    {% if not is_owner%}
                    <div class="container text-center mb-5">
                        <button type="button" class="btn btn-danger mx-auto" style="height: 60px;font-size:20px"data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                          Report Post
                        </button>
                    </div>
                      <!-- Modal -->
                    <form class ="row g-3 align-items-center" action = "" method = 'POST'>
                    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Briefly explain why you report this post</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">                            
                                    <textarea type="text" class="form-control mt-3 mb-2" placeholder = "Type here" id="floatingTextarea2" name='rp_content'>
                                    </textarea>
                                </div>

                                <div class="modal-footer">  
                                    {% csrf_token %}     
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        <button type="submit" class="btn btn-danger" name='action' value='report'>Report</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form> 
                    {%endif%} 
                </div>
            </div>
        </div>
    </div>

    <!-- Hide and Delete post-->
    {% if is_owner %}
    <div class="container">
        <hr class="my-4">
        <div class="d-flex justify-content-center">
            <!-- Remove the 'd-grid' class from the container holding the buttons -->
            <div class="d-flex gap-2">
                {% if not post.is_hidden %}
                <form method="POST" action="{% url 'post' post.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="hide">
                    <button type="submit" class="btn btn-secondary btn-lg col-sm-25">Hide Post</button>
                </form>
                {% else %}
                <form method="POST" action="{% url 'post' post.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="unhide">
                    <button type="submit" class="btn btn-primary btn-lg col-sm-25">Unhide Post</button>
                </form>
                {% endif %}
                <form method="POST" action="{% url 'post' post.id %}">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="delete">
                    <button type="submit" class="btn btn-danger btn-lg col-sm-25">Delete Post</button>
                </form>
                <a href="{% url 'edit_post' pk=post.id %}" class="btn btn-primary btn-lg col-sm-25">Edit Post</a>
            </div>
        </div>
    </div>
    {% endif %}
    <!-- Like and dislike buttons -->
    <div class="container">
        <div class="d-flex flex-row align-items-center mb-5 mt-5 mx-5">
            
            <form method="POST" action="{% url 'post' post.id %}">
                {% csrf_token %}

                {% if post.is_liked%}
                <button type="submit" name="action" value="like" class ="btn btn-primary btn-lg mx-2"><i class="bi bi-hand-thumbs-up-fill "></i></i> ({{ post.likes.count }})</button>
                {% else %}
                <button type="submit" name="action" value="like" class ="btn btn-secondary btn-lg mx-2"><i class="bi bi-hand-thumbs-up "></i></i> ({{ post.likes.count }})</button>
                {% endif %}

                {% if  post.is_disliked%}
                <button type="submit" name="action" value="dislike" class ="btn btn-danger btn-lg mx-2"><i class="bi bi-hand-thumbs-down-fill "></i> ({{ post.dislikes.count }})</button>
                {% else %}  
                <button type="submit" name="action" value="dislike" class ="btn btn-secondary btn-lg mx-2"><i class="bi bi-hand-thumbs-down "></i></i> ({{ post.dislikes.count }})</button>
                {% endif %}
            

            </form>
        </div>
    </div>

   <div class="container">
        <div class="row d-flex justify-content-center align-items-center">
            <!-- Comment section -->
            <h1>Comments:</h1>
        </div>
        <!-- Comment form -->
        <div class="row d-flex justify-content-center align-items-center">
            <form method="POST" action="{% url 'post' post.id %}">
                {% csrf_token %}
                <i class="fas fa-key fa-lg fa-fw"></i>
                <div class="form-outline flex-fill">
                    <p><strong>{{ comment.user.username }}</strong></p>
                    <label for="floatingTextarea2"></label>
                    <textarea name="comment_content" class="col-md-3 form-control" style="height:120px" placeholder="Write a comment"></textarea>
                    <button type="submit" name="action" value="comment" class="btn btn-primary mt-4">Post Comment</button>
                </div>
            </form>
        </div>

        {% for comment in comments %}
    
        <div class="row d-flex justify-content-center align-items-center">
            <div class="comment">
                <div class="card mt-4 col-md-6">
                    <p style="margin-left: 15px; margin-right: 15px;">
                        <strong><a href="{% url 'profile' username=comment.user.username %}" style="margin-right: 10px;">{{ comment.user.username }}</a></strong>
                        - {{ comment.created_at|timesince }} ago
                    </p>
                    <p style="margin-left: 15px; margin-right: 15px;">{{ comment.content }}</p>
                </div>
            </div>
        </div>
                    <div class="d-flex">
                        <form method="POST" action="{% url 'post' post.id %}">
                            {% csrf_token %}
                            <input type="hidden" name="action" value="like_comment">
                            <input type="hidden" name="comment_id" value="{{ comment.id }}">
                            <button type="submit" class="btn btn-primary btn-sm me-2">
                                <i class="bi bi-hand-thumbs-up-fill"></i>
                                {{ comment.likes.count }}
                            </button>
                        </form>
                        <form method="POST" action="{% url 'post' post.id %}">
                            {% csrf_token %}
                            <input type="hidden" name="action" value="dislike_comment">
                            <input type="hidden" name="comment_id" value="{{ comment.id }}">
                            <button type="submit" class="btn btn-danger btn-sm me-2">
                                <i class="bi bi-hand-thumbs-down-fill"></i>
                                {{ comment.dislikes.count }}
                            </button>
                        </form>
                        {% comment %} <button type="submit" name="action" value="comment" class="btn btn-danger btn-sm" style="margin-left: 50px;">Report comment</button> {% endcomment %}
            </div>
        </div>
    </div>
{% endfor %}
    </div>

</section>

<script src="" async defer></script>
</body>

</html>

{% endblock main-content %}
